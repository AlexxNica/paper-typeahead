<link rel="import" href="bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="bower_components/paper-styles/paper-styles.html">
<link rel="import" href="bower_components/paper-item/paper-item.html">
<link rel="import" href="bower_components/iron-menu-behavior/iron-menu-behavior.html">

<dom-module id="paper-typeahead-results">
  <template>
    <style>
      paper-item:hover {
        background: var(--google-grey-100);
      }
      paper-item {
        cursor: pointer;
        position: relative;
        border-bottom: solid 1px var(--google-grey-500);
      }
    </style>
    <template is="dom-repeat" items="[[results]]">
      <paper-item class='result-item' on-tap="onSelected" on-keypress="onKeyPress">
        <paper-item-body>
          <span>[[item]]</span>
          <paper-ripple></paper-ripple>
        </paper-item-body>
      </paper-item>
    </template>
  </template>
</dom-module>
<script>
  (function() {
    'use strict';

    Polymer({
      is: 'paper-typeahead-results',
      properties: {
        results: Array,
        selectable: {
          type: String,
          value: '.result-item'
        }
      },
      observers: [
        'updateSelectable(results, selectable)'
      ],
      behaviors: [
        Polymer.IronMenuBehavior
      ],
      updateSelectable: function() {
        this.async(function() {
          this._resetTabindices();
        });
      },
      onKeyPress: function(e) {
        if (e.which === 13) {
          this.onSelected(e);
        }
      },
      onSelected: function(e) {
        this.fire('selected', {target: e.model.item});
      },
      // https://github.com/PolymerElements/iron-selector/blob/master/iron-selectable.html#L153
      // is not working as expected
      get items() {
        return Array.from(
            this.querySelectorAll(this.selectable));
      }
    });
  })();
</script>

